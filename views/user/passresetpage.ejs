<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Your New Password - Mobi World</title>
    <link rel="stylesheet" href="/css/forgetpasswordpage.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    
</head>
<body>
    <div class="container">
        <div class="left-section">
            <div class="platform"></div>
            <div class="store-logo">
                Online<br>Store
            </div>
            <div >
                <div class="left-content">
                    <h2>Create Your New Password</h2>
                    <p>Set a strong password to keep your account secure. Once done, you'll be ready to continue shopping with ease!</p>
                </div>
                <div class="decorative-elements">
                    <div class="decorative-box" style="height: 40px;"></div>
                    <div class="decorative-box" style="height: 60px;"></div>
                    <div class="decorative-box" style="height: 50px;"></div>
                    <div class="decorative-box" style="height: 70px;"></div>
                </div>
            </div>
        </div>
        <div class="right-section">
            <div class="logo">
                <img src="images/3d-illustration-smartphone-with-paper-bags-gift-boxes-online-shopping-e-commerce-concept.jpg" alt="Mobi World">
            </div>
            <h1>Enter Your New Password</h1>
            <p>Set a strong password to keep your account secure. Once done, you'll be ready to continue shopping with ease!</p>
            
            <form method="post" action="/user/passreset">
                <!-- <div class="form-group">
                    <label for="password">New Password</label>
                    <input type="password" id="password" name="password">
                </div>
                
                <div class="form-group">
                    <label for="confirm-password">Confirmation Password</label>
                    <input type="password" id="confirm-password" name="confirmpassword">
                </div> -->
                <div class="form-group" style="position: relative;">
                    <label for="password">New Password</label>
                    <input type="password" id="password" name="password" class="form-control">
                    <i class="fa-solid fa-eye" id="togglePassword" style="position: absolute; right: 15px; top: 50%; transform: translateY(-50%); cursor: pointer;"></i>
                </div>
                
                <div class="form-group" style="position: relative; margin-top: 20px;">
                    <label for="confirm-password">Confirm Password</label>
                    <input type="password" id="confirm-password" name="confirmpassword" class="form-control">
                    <i class="fa-solid fa-eye" id="toggleConfirmPassword" style="position: absolute; right: 15px; top: 50%; transform: translateY(-50%); cursor: pointer;"></i>
                </div>
                <p id="error-message" style="color: red; margin-top: 10px; display: none;"></p>
                <% if (message) { %>
                    <p class="error-message" id="mess"><%= message %></p> 
                <% } %>
                <button type="submit">Submit</button>
            </form>
        </div>
    </div>
    <script>
        const password = document.getElementById('password').value
        const confirmpassword = document.getElementById('confirm-password').value
        const mess = document.getElementById('mess')
        setTimeout(()=>{
            if(mess){
              mess.style.display = 'none'
            }
        },3000)
        
        const togglePassword = document.getElementById('togglePassword');
    const passwordInput = document.getElementById('password');
    
    togglePassword.addEventListener('click', function () {
        const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
        passwordInput.setAttribute('type', type);
        this.classList.toggle('fa-eye');
        this.classList.toggle('fa-eye-slash');
    });

    const toggleConfirmPassword = document.getElementById('toggleConfirmPassword');
    const confirmPasswordInput = document.getElementById('confirm-password');
    
    toggleConfirmPassword.addEventListener('click', function () {
        const type = confirmPasswordInput.getAttribute('type') === 'password' ? 'text' : 'password';
        confirmPasswordInput.setAttribute('type', type);
        this.classList.toggle('fa-eye');
        this.classList.toggle('fa-eye-slash');
    });

        const form = document.querySelector('form');

        form.addEventListener('submit', function(e) {
            if (!validatePassword(e)) {
                // If validation fails, prevent the form from submitting
                e.preventDefault();
            }
        });


    // Validate password
    function validatePassword(e) {
    const password = passwordInput.value.trim();
    const confirmPassword = confirmPasswordInput.value.trim();
    const errorMessage = document.getElementById('error-message');

    const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&#^()_\-+=])[A-Za-z\d@$!%*?&#^()_\-+=]{8,}$/;

    // Check for empty fields
    if (!password || !confirmPassword) {
        errorMessage.innerText = "Both fields are required.";
        errorMessage.style.display = "block";
        return false;
    }

    // Check password strength
    if (!passwordRegex.test(password)) {
        errorMessage.innerText = "Password must be at least 8 characters, include uppercase, lowercase, number, and special character.";
        errorMessage.style.display = "block";
        return false;
    }

    // Check if passwords match
    if (password !== confirmPassword) {
        errorMessage.innerText = "Passwords do not match.";
        errorMessage.style.display = "block";
        return false;
    }

    // If everything is correct
    errorMessage.style.display = "none";
    return true;
}


    </script>
</body>
</html>