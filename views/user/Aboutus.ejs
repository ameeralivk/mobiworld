<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact Us</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Arial', sans-serif;
        }
        .header-section {
            background-color: #7fe3f0;
            height: 300px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            margin-bottom: 40px;
        }
        .header-section h1 {
            font-size: 3.5rem;
            font-weight: bold;
        }
        .contact-info-box {
            background: #ffffff;
            border: 1px solid #e9ecef;
            padding: 30px 20px;
            margin-bottom: 20px;
            text-align: center;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .contact-info-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }
        .contact-info-box i {
            font-size: 2rem;
            color: #7fe3f0;
            margin-bottom: 15px;
        }
        .contact-info-box h5 {
            color: #5a5a5a;
            font-weight: bold;
            margin-bottom: 15px;
            text-transform: uppercase;
        }
        .contact-info-box p {
            color: #6c757d;
            margin-bottom: 0;
        }
        .map-section {
            border: 1px solid #e9ecef;
            padding: 10px;
            height: 400px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        .form-section {
            background: #ffffff;
            border: 1px solid #e9ecef;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            height: 100%;
        }
        .form-control {
            border-radius: 5px;
            border-color: #ced4da;
            padding: 12px 15px;
            margin-bottom: 20px;
        }
        .form-control:focus {
            border-color: #7fe3f0;
            box-shadow: 0 0 5px rgba(127, 227, 240, 0.5);
        }
        .btn-send {
            background: #7fe3f0;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            transition: background 0.3s;
            text-transform: uppercase;
            font-weight: bold;
            letter-spacing: 1px;
        }
        .btn-send:hover {
            background: #5fd1e0;
        }
        .section-title {
            text-align: center;
            margin-bottom: 40px;
        }
        .section-title h2 {
            color: #5a5a5a;
            position: relative;
            display: inline-block;
            padding-bottom: 15px;
        }
        .section-title h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background-color: #7fe3f0;
        }
        .error-feedback {
            color: #dc3545;
            font-size: 0.875rem;
            margin-top: -15px;
            margin-bottom: 15px;
            display: none;
        }
        .form-control.is-invalid {
            border-color: #dc3545;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23dc3545'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right calc(0.375em + 0.1875rem) center;
            background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
        }
        .custom-color {
            background-color: #7fe3f0 !important;; 
            border: none;
            color: white;
            transition: background 0.3s ease-in-out;
        }

        .custom-color:hover {
            background-color: #aebbbc !important; /* Darker blue on hover */
            color: white;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="\css\shoppage_header.css">
</head>
<body>
    <%- include("../../views/partials/user/shoppage_header") %>
    
    <!-- Header Section -->
    <div class="header-section">
        <h1>CONTACT US</h1>
    </div>

    <!-- Main Content -->
    <div class="container">
        <!-- Contact Information -->
        <div class="section-title">
            <h2>Get In Touch</h2>
        </div>
        
        <div class="row g-4 mb-5">
            <div class="col-md-3">
                <div class="contact-info-box">
                    <i class="fas fa-map-marker-alt"></i>
                    <h5>ADDRESS</h5>
                    <p>Kinfra Industrial Park, Kakkanchery, Kozhikode, Kerala</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="contact-info-box">
                    <i class="fas fa-phone-alt"></i>
                    <h5>PHONE</h5>
                    <p>+91 9778364599</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="contact-info-box">
                    <i class="fas fa-envelope"></i>
                    <h5>EMAIL</h5>
                    <p>mobiworld.com</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="contact-info-box">
                    <i class="fas fa-globe"></i>
                    <h5>WEBSITE</h5>
                    <p>moobiworld.shop</p>
                </div>
            </div>
        </div>

        <div class="row g-4 mb-5">
            <!-- Map Section -->
            <div class="col-lg-6 mb-4 mb-lg-0">
                <div class="map-section">
                    <iframe 
                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3914.4726666763686!2d75.88980567355765!3d11.152596852145587!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3ba6502f41ef4e8b%3A0xf4c653a7548cccd!2sKinfra%20Techno%20Industrial%20Park!5e0!3m2!1sen!2sin!4v1745724302157!5m2!1sen!2sin" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade" 
                        width="100%" 
                        height="100%" 
                        style="border:0; border-radius:10px;" 
                        allowfullscreen="" 
                        loading="lazy">
                    </iframe>
                </div>
            </div>
            
            <!-- Contact Form -->
            <div class="col-lg-6">
                <div class="form-section">
                    <h4 class="mb-4" style="color: #5a5a5a; font-weight: bold;">Send Us A Message</h4>
                    <form id="contact-form" novalidate>
                        <div class="row">
                            <div class="col-md-6">
                                <input type="text" class="form-control" name="user_name" id="user_name" placeholder="YOUR NAME" required>
                                <div class="error-feedback" id="name-error">Please enter your name</div>
                            </div>
                            <div class="col-md-6">
                                <input type="email" class="form-control" name="user_email" id="user_email" placeholder="YOUR EMAIL" required>
                                <div class="error-feedback" id="email-error">Please enter a valid email address</div>
                            </div>
                        </div>
                        <input type="text" class="form-control" name="subject" id="subject" placeholder="SUBJECT" required>
                        <div class="error-feedback" id="subject-error">Please enter a subject</div>
                        <textarea class="form-control" name="message" id="message" rows="5" placeholder="MESSAGE" required></textarea>
                        <div class="error-feedback" id="message-error">Please enter your message</div>
                        <div class="text-end">
                            <button type="submit" class="btn btn-send custom-color">SEND MESSAGE</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS and Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        fetch('/config')
            .then(response => response.json())
            .then(config => {
                const { EMAILJS_PUBLIC_KEY, EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID } = config;

                // Initialize EmailJS with the fetched public key
                emailjs.init(EMAILJS_PUBLIC_KEY);

                // Form validation function
                function validateForm() {
                    let isValid = true;
                    
                    // Validate name
                    const nameInput = document.getElementById('user_name');
                    const nameError = document.getElementById('name-error');
                    if (!nameInput.value.trim()) {
                        nameInput.classList.add('is-invalid');
                        nameError.style.display = 'block';
                        isValid = false;
                    } else {
                        nameInput.classList.remove('is-invalid');
                        nameError.style.display = 'none';
                    }
                    
                    // Validate email
                    const emailInput = document.getElementById('user_email');
                    const emailError = document.getElementById('email-error');
                    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    if (!emailInput.value.trim() || !emailRegex.test(emailInput.value.trim())) {
                        emailInput.classList.add('is-invalid');
                        emailError.style.display = 'block';
                        isValid = false;
                    } else {
                        emailInput.classList.remove('is-invalid');
                        emailError.style.display = 'none';
                    }
                    
                    // Validate subject
                    const subjectInput = document.getElementById('subject');
                    const subjectError = document.getElementById('subject-error');
                    if (!subjectInput.value.trim()) {
                        subjectInput.classList.add('is-invalid');
                        subjectError.style.display = 'block';
                        isValid = false;
                    } else {
                        subjectInput.classList.remove('is-invalid');
                        subjectError.style.display = 'none';
                    }
                    
                    // Validate message
                    const messageInput = document.getElementById('message');
                    const messageError = document.getElementById('message-error');
                    if (!messageInput.value.trim()) {
                        messageInput.classList.add('is-invalid');
                        messageError.style.display = 'block';
                        isValid = false;
                    } else {
                        messageInput.classList.remove('is-invalid');
                        messageError.style.display = 'none';
                    }
                    
                    return isValid;
                }

                // Add input event listeners for real-time validation
                const formInputs = document.querySelectorAll('#contact-form input, #contact-form textarea');
                formInputs.forEach(input => {
                    input.addEventListener('input', function() {
                        const errorElement = document.getElementById(`${input.id}-error`);
                        if (input.value.trim()) {
                            // For email, do additional regex validation
                            if (input.type === 'email') {
                                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                                if (emailRegex.test(input.value.trim())) {
                                    input.classList.remove('is-invalid');
                                    errorElement.style.display = 'none';
                                } else {
                                    input.classList.add('is-invalid');
                                    errorElement.style.display = 'block';
                                }
                            } else {
                                input.classList.remove('is-invalid');
                                errorElement.style.display = 'none';
                            }
                        } else {
                            input.classList.add('is-invalid');
                            errorElement.style.display = 'block';
                        }
                    });
                });

                // Handle form submission
                document.getElementById('contact-form').addEventListener('submit', function(event) {
                    event.preventDefault();
                    
                    // Validate form before submission
                    if (!validateForm()) {
                        return;
                    }

                    // Show loading state
                    Swal.fire({
                        title: 'Sending...',
                        text: 'Please wait while we send your message',
                        allowOutsideClick: false,
                        didOpen: () => {
                            Swal.showLoading();
                        }
                    });

                    // Send the form
                    emailjs.sendForm(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, this)
                        .then(function(response) {
                            Swal.fire({
                                icon: 'success',
                                title: 'Message Sent!',
                                text: 'We will contact you shortly.',
                                confirmButtonColor: '#3085d6',
                            });
                            document.getElementById('contact-form').reset(); // Clear form
                        }, function(error) {
                            Swal.fire({
                                icon: 'error',
                                title: 'Oops...',
                                text: 'Something went wrong. Please try again!',
                                confirmButtonColor: '#d33',
                            });
                        });
                });
            })
            .catch(error => {
                console.error('Error fetching config:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Configuration Error',
                    text: 'There was a problem loading the contact form. Please try again later.',
                    confirmButtonColor: '#d33',
                });
            });
    });
    </script>
</body>
</html>