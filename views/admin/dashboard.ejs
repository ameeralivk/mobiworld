<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            padding: 20px;
        }
        
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            background-color: white;
            padding: 15px 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .filter-controls {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .filter-controls select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: white;
            cursor: pointer;
        }
        
        .charts-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        @media (min-width: 768px) {
            .charts-container {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        .chart-card {
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        .big-chart {
            grid-column: 1 / -1;
        }
        
        .table-container {
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-top: 20px;
            overflow-x: auto;
        }
        
        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .orders-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .orders-table th, .orders-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .orders-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #333;
        }
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-delivered {
            background-color: #d1f3d1;
            color: #0d6e0d;
        }
        
        .status-processing {
            background-color: #fff8dd;
            color: #8a6d00;
        }
        
        .status-cancelled {
            background-color: #ffe6e6;
            color: #c30000;
        }
        
        .action-btn {
            cursor: pointer;
            color: #3498db;
            margin-right: 10px;
        }
        
        .page-title {
            font-size: 24px;
            font-weight: 600;
            color: #333;
        }
    </style>
</head>
<body>
    <%- include("../../views/partials/admin/layout") %>
    <!-- Top Bar -->
    <div class="top-bar">
        <h1 class="page-title">Sales Dashboard</h1>
        <div class="filter-controls">
            <select id="time-filter" onchange="updateCharts()">
                <option value="daily">Daily</option>
                <option value="weekly">Weekly</option>
                <option value="monthly" selected>Monthly</option>
                <option value="yearly">Yearly</option>
            </select>
            <select id="year-filter" onchange="updateCharts()">
                <option value="2025">2025</option>
                <option value="2024" selected>2024</option>
                <option value="2023">2023</option>
            </select>
        </div>
    </div>
    
    <!-- Main Chart -->
    <div class="chart-card big-chart">
        <div class="chart-header">
            <h2 class="chart-title">Sales Overview</h2>
        </div>
        <div class="chart-container">
            <canvas id="salesOverviewChart"></canvas>
        </div>
    </div>
    
    <!-- Charts Container -->
    <div class="charts-container">
        <!-- Best Selling Products Chart -->
        <div class="chart-card">
            <div class="chart-header">
                <h2 class="chart-title">Best Selling Products (Top 10)</h2>
            </div>
            <div class="chart-container">
                <canvas id="productsChart"></canvas>
            </div>
        </div>
        
        <!-- Best Selling Categories Chart -->
        <div class="chart-card">
            <div class="chart-header">
                <h2 class="chart-title">Best Selling Categories (Top 10)</h2>
            </div>
            <div class="chart-container">
                <canvas id="categoriesChart"></canvas>
            </div>
        </div>
        
        <!-- Best Selling Brands Chart -->
        <div class="chart-card">
            <div class="chart-header">
                <h2 class="chart-title">Best Selling Brands (Top 10)</h2>
            </div>
            <div class="chart-container">
                <canvas id="brandsChart"></canvas>
            </div>
        </div>
        
        <!-- Order Status Chart -->
        <div class="chart-card">
            <div class="chart-header">
                <h2 class="chart-title">Order Status Distribution</h2>
            </div>
            <div class="chart-container">
                <canvas id="orderStatusChart"></canvas>
            </div>
        </div>
    </div>
    
    <!-- Orders Table -->
    <div class="table-container">
        <div class="table-header">
            <h2 class="chart-title">Recent Orders</h2>
        </div>
        <table class="orders-table">
            <thead>
                <tr>
                    <th>Order ID</th>
                    <th>Customer</th>
                    <th>Date</th>
                    <th>Amount</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>#ORD-5543</td>
                    <td>John Smith</td>
                    <td>04 Apr 2025</td>
                    <td>$329.95</td>
                    <td><span class="status-badge status-delivered">Delivered</span></td>
                    <td>
                        <i class="fas fa-eye action-btn"></i>
                        <i class="fas fa-print action-btn"></i>
                    </td>
                </tr>
                <tr>
                    <td>#ORD-5542</td>
                    <td>Maria Garcia</td>
                    <td>03 Apr 2025</td>
                    <td>$124.00</td>
                    <td><span class="status-badge status-processing">Processing</span></td>
                    <td>
                        <i class="fas fa-eye action-btn"></i>
                        <i class="fas fa-print action-btn"></i>
                    </td>
                </tr>
                <tr>
                    <td>#ORD-5541</td>
                    <td>Robert Johnson</td>
                    <td>03 Apr 2025</td>
                    <td>$79.99</td>
                    <td><span class="status-badge status-delivered">Delivered</span></td>
                    <td>
                        <i class="fas fa-eye action-btn"></i>
                        <i class="fas fa-print action-btn"></i>
                    </td>
                </tr>
                <tr>
                    <td>#ORD-5540</td>
                    <td>Sarah Wilson</td>
                    <td>02 Apr 2025</td>
                    <td>$249.50</td>
                    <td><span class="status-badge status-cancelled">Cancelled</span></td>
                    <td>
                        <i class="fas fa-eye action-btn"></i>
                        <i class="fas fa-print action-btn"></i>
                    </td>
                </tr>
                <tr>
                    <td>#ORD-5539</td>
                    <td>Michael Brown</td>
                    <td>01 Apr 2025</td>
                    <td>$149.95</td>
                    <td><span class="status-badge status-delivered">Delivered</span></td>
                    <td>
                        <i class="fas fa-eye action-btn"></i>
                        <i class="fas fa-print action-btn"></i>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Chart.js Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    
    <script>
        // Data for different time periods
        const chartData = {
            daily: {
                salesOverview: [420, 380, 450, 520, 480, 550, 600, 520, 490, 550, 620, 590],
                products: [42, 38, 35, 32, 30, 28, 26, 24, 22, 20],
                categories: [38, 24, 12, 8, 6, 5, 3, 2, 1, 1],
                brands: [40, 35, 32, 28, 25, 20, 18, 15, 12, 10],
                orderStatus: [65, 25, 10]
            },
            weekly: {
                salesOverview: [3200, 3600, 4200, 4800, 4500, 5000, 5500, 5200, 4900, 5300, 5800, 6200],
                products: [320, 280, 250, 210, 190, 170, 150, 130, 120, 110],
                categories: [36, 25, 14, 9, 6, 4, 3, 2, 1, 0],
                brands: [38, 32, 28, 24, 20, 18, 15, 12, 10, 8],
                orderStatus: [60, 30, 10]
            },
            monthly: {
                salesOverview: [12500, 14000, 18500, 22000, 19500, 21000, 25000, 27000, 24500, 23000, 28000, 32000],
                products: [1250, 980, 875, 760, 680, 590, 520, 480, 420, 390],
                categories: [35, 25, 15, 10, 5, 3, 2, 2, 2, 1],
                brands: [30, 25, 20, 15, 10, 8, 7, 6, 5, 4],
                orderStatus: [55, 35, 10]
            },
            yearly: {
                salesOverview: [150000, 168000, 204000, 240000, 228000, 252000, 276000, 300000, 288000, 264000, 312000, 348000],
                products: [15000, 12000, 10500, 9000, 7500, 6800, 6200, 5500, 5000, 4500],
                categories: [40, 22, 14, 8, 6, 4, 2, 2, 1, 1],
                brands: [35, 28, 22, 18, 12, 8, 6, 5, 4, 2],
                orderStatus: [50, 40, 10]
            }
        };
        
        // Labels for charts
        const labels = {
            salesOverview: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
            products: ['iPhone 15 Pro', 'Samsung TV 55"', 'AirPods Pro', 'MacBook Air', 'PlayStation 5', 'Nike Air Max', 'Dyson Vacuum', 'Amazon Echo', 'Fitbit Charge', 'Nintendo Switch'],
            categories: ['Electronics', 'Clothing', 'Home & Kitchen', 'Beauty', 'Sports', 'Books', 'Toys', 'Automotive', 'Health', 'Garden'],
            brands: ['Apple', 'Samsung', 'Sony', 'Nike', 'Adidas', 'LG', 'Dyson', 'Amazon', 'Fitbit', 'Nintendo'],
            orderStatus: ['Delivered', 'Processing', 'Cancelled']
        };
        
        // Colors for charts
        const colors = {
            salesOverview: {
                backgroundColor: '#3498db',
                borderColor: '#2980b9'
            },
            products: {
                backgroundColor: '#2ecc71',
                borderColor: '#27ae60'
            },
            categories: [
                '#3498db', '#2ecc71', '#e74c3c', '#f39c12', 
                '#9b59b6', '#1abc9c', '#34495e', '#d35400',
                '#c0392b', '#16a085'
            ],
            brands: [
                '#f1c40f', '#e67e22', '#e74c3c', '#9b59b6', 
                '#3498db', '#2ecc71', '#1abc9c', '#34495e',
                '#d35400', '#c0392b'
            ],
            orderStatus: ['#2ecc71', '#f39c12', '#e74c3c']
        };
        
        // Initialize charts
        let salesOverviewChart, productsChart, categoriesChart, brandsChart, orderStatusChart;
        
        // Function to initialize all charts
        function initializeCharts() {
            // Sales Overview Chart
            const salesCtx = document.getElementById('salesOverviewChart').getContext('2d');
            salesOverviewChart = new Chart(salesCtx, {
                type: 'bar',
                data: {
                    labels: labels.salesOverview,
                    datasets: [{
                        label: 'Sales ($)',
                        data: chartData.monthly.salesOverview,
                        backgroundColor: colors.salesOverview.backgroundColor,
                        borderColor: colors.salesOverview.borderColor,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toLocaleString();
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    }
                }
            });

            // Best Selling Products Chart
            const productsCtx = document.getElementById('productsChart').getContext('2d');
            productsChart = new Chart(productsCtx, {
                type: 'bar',
                data: {
                    labels: labels.products,
                    datasets: [{
                        label: 'Units Sold',
                        data: chartData.monthly.products,
                        backgroundColor: colors.products.backgroundColor,
                        borderColor: colors.products.borderColor,
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    }
                }
            });

            // Best Selling Categories Chart
            const categoriesCtx = document.getElementById('categoriesChart').getContext('2d');
            categoriesChart = new Chart(categoriesCtx, {
                type: 'pie',
                data: {
                    labels: labels.categories,
                    datasets: [{
                        data: chartData.monthly.categories,
                        backgroundColor: colors.categories
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                boxWidth: 12
                            }
                        }
                    }
                }
            });

            // Best Selling Brands Chart
            const brandsCtx = document.getElementById('brandsChart').getContext('2d');
            brandsChart = new Chart(brandsCtx, {
                type: 'doughnut',
                data: {
                    labels: labels.brands,
                    datasets: [{
                        data: chartData.monthly.brands,
                        backgroundColor: colors.brands
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                boxWidth: 12
                            }
                        }
                    }
                }
            });

            // Order Status Chart
            const orderStatusCtx = document.getElementById('orderStatusChart').getContext('2d');
            orderStatusChart = new Chart(orderStatusCtx, {
                type: 'polarArea',
                data: {
                    labels: labels.orderStatus,
                    datasets: [{
                        data: chartData.monthly.orderStatus,
                        backgroundColor: colors.orderStatus
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                boxWidth: 12
                            }
                        }
                    }
                }
            });
        }
        
        // Function to update charts based on filter selection
        function updateCharts() {
            const timeFilter = document.getElementById('time-filter').value;
            const yearFilter = document.getElementById('year-filter').value;
            
            // Update chart data
            salesOverviewChart.data.datasets[0].data = chartData[timeFilter].salesOverview;
            productsChart.data.datasets[0].data = chartData[timeFilter].products;
            categoriesChart.data.datasets[0].data = chartData[timeFilter].categories;
            brandsChart.data.datasets[0].data = chartData[timeFilter].brands;
            orderStatusChart.data.datasets[0].data = chartData[timeFilter].orderStatus;
            
            // Update chart titles based on time filter
            document.querySelectorAll('.chart-title')[0].textContent = `Sales Overview (${timeFilter}, ${yearFilter})`;
            document.querySelectorAll('.chart-title')[1].textContent = `Best Selling Products (Top 10, ${timeFilter})`;
            document.querySelectorAll('.chart-title')[2].textContent = `Best Selling Categories (Top 10, ${timeFilter})`;
            document.querySelectorAll('.chart-title')[3].textContent = `Best Selling Brands (Top 10, ${timeFilter})`;
            document.querySelectorAll('.chart-title')[4].textContent = `Order Status Distribution (${timeFilter})`;
            
            // Update charts
            salesOverviewChart.update();
            productsChart.update();
            categoriesChart.update();
            brandsChart.update();
            orderStatusChart.update();
        }
        
        // Initialize charts when page loads
        window.onload = function() {
            initializeCharts();
        };
        
        // Handle window resize to make charts responsive
        window.addEventListener('resize', function() {
            if (salesOverviewChart) salesOverviewChart.resize();
            if (productsChart) productsChart.resize();
            if (categoriesChart) categoriesChart.resize();
            if (brandsChart) brandsChart.resize();
            if (orderStatusChart) orderStatusChart.resize();
        });
    </script>
</body>
</html>